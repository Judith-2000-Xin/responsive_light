<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>光語言系統評分研究</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html{overflow-x:hidden;width:100%}
  body{font-family:'Microsoft JhengHei',Arial,sans-serif;background:linear-gradient(135deg,#0f1419 0%,#1a2332 100%);color:#fff;min-height:100vh;overflow-x:hidden;width:100%;position:relative;padding-top:20px; padding-bottom:20px;}  /* Added padding here */

  .page{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    min-height:100vh;
    max-width:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    opacity:0;
    transform:translateX(100px);
    transition:all .45s ease;
    z-index:1;
    overflow-y:auto;
    overflow-x:hidden;
    padding:10px;
    box-sizing:border-box;
    padding-top:20px;  /* Added padding here */
    padding-bottom:20px;  /* Added padding here */
  }
  .page.active{opacity:1;transform:translateX(0);z-index:10}
  .page.prev{transform:translateX(-100px)}

  /* 確保所有頁面內容居中但文字靠左 */
  .intro-page{
    text-align:left;
    max-width:100%;
    width:100%;
    box-sizing:border-box;
  }
  .intro-title{
    font-size:clamp(24px, 4vw, 36px);
    color:#64b5f6;
    margin-bottom:30px;
    text-shadow:0 0 20px rgba(66,165,245,.5);
    text-align:center;
  }
  .intro-content{
    font-size:clamp(14px, 2.5vw, 18px);
    line-height:1.8;
    margin-bottom:40px;
    color:#e0e0e0;
    text-align:left;
  }
  .intro-content h3{
    color:#90caf9;
    margin:25px 0 15px;
    font-size:clamp(16px, 3vw, 22px);
    text-align:left;
  }

  .profile-page{
    max-width:100%;
    width:100%;
    box-sizing:border-box;
  }
  .form-group{
    margin-bottom:30px;
    width:100%;
    box-sizing:border-box;
  }
  .form-title{
    font-size:clamp(16px, 2.8vw, 20px);
    color:#90caf9;
    margin-bottom:15px;
    text-align:left;
  }
  .checkbox-group{
    display:grid;
    grid-template-columns:1fr;
    gap:15px;
    margin-bottom:12px;
    width:100%;
    box-sizing:border-box;
  }
  .checkbox-item{
    display:flex;
    align-items:center;
    gap:10px;
    padding:15px 20px;
    background:rgba(50,70,90,.6);
    border:2px solid rgba(100,120,180,.3);
    border-radius:10px;
    cursor:pointer;
    transition:all .2s ease;
    user-select:none;
    font-size:16px;
    width:100%;
    box-sizing:border-box;
    min-height:50px;
  }
  .checkbox-item:hover{background:rgba(70,90,120,.8);border-color:rgba(120,140,200,.6)}
  .checkbox-item.selected{background:rgba(100,120,180,.4);border-color:#42a5f5}
  .checkbox-item input{
    width:clamp(14px, 2.5vw, 18px);
    height:clamp(14px, 2.5vw, 18px);
    pointer-events:none;
  }
  .other-input{
    width:100%;
    padding:12px;
    margin-top:10px;
    background:rgba(50,70,90,.8);
    border:2px solid rgba(100,120,180,.3);
    border-radius:8px;
    color:#fff;
    font-size:clamp(12px, 2.2vw, 16px);
  }
  .other-input:focus{outline:none;border-color:#42a5f5}

  .light-page{
    padding:10px;
    justify-content:flex-start;
    align-items:center;
    gap:15px;
    max-width:100%;
    width:100%;
    box-sizing:border-box;
  }
  .light-display{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:15px;
    width:100%;
    max-width:100%;
    box-sizing:border-box;
  }
  .light-title{
    font-size:clamp(20px, 3.5vw, 28px);
    color:#64b5f6;
    text-shadow:0 0 30px rgba(66,165,245,.3);
    text-align:center;
  }
  .light-canvas{
    width:95%;
    height:95vw;
    max-width:450px;
    max-height:450px;
    border:1px solid rgba(100,120,180,.2);
    border-radius:10px;
    box-sizing:border-box;
    aspect-ratio:1/1;
  }
  .light-description{
    text-align:center;
    font-size:clamp(12px, 2.2vw, 16px);
    color:#b0b0b0;
    max-width:min(90vw, 520px);
    line-height:1.5;
  }

  /* LED 色溫條：響應式設計 */
  .led-wrap{
    width:95%;
    max-width:450px;
    box-sizing:border-box;
  }
  .led-strip{
    width:100%;
    height:clamp(20px, 3vw, 24px);
    position:relative;
    border-radius:16px;
    overflow:hidden;
    box-shadow:0 6px 22px rgba(255,255,255,.18);
    background:linear-gradient(90deg,#ff6a00 0%,#ffd38a 40%,#ffffff 100%);
  }
  .led-gloss{position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,.55),rgba(255,255,255,.15));box-shadow:inset 0 2px 6px rgba(255,255,255,.5),inset 0 -3px 10px rgba(0,0,0,.22);pointer-events:none}
  .lightbar{
    position:absolute;top:50%;left:0;transform:translateY(-50%);
    width:14%;height:70%;border-radius:999px;pointer-events:none;
    background:radial-gradient(closest-side,rgba(255,255,255,.95),rgba(255,255,255,.35) 60%,rgba(255,255,255,0) 70%);
    filter:blur(1px);
    animation:lightbarSweep var(--sweep-duration,3.2s) linear infinite;
  }
  @keyframes lightbarSweep{0%{left:0%}100%{left:100%}}
  .led-indicator{
    position:absolute;
    top:50%;
    width:clamp(24px, 4vw, 30px);
    height:clamp(24px, 4vw, 30px);
    border-radius:50%;
    transform:translate(-50%,-50%);
    background:#fff;
    border:2px solid rgba(0,0,0,.15);
    box-shadow:0 0 22px rgba(255,255,255,.85),0 0 8px rgba(255,255,255,.75) inset;
  }
  .temperature-labels{
    width:100%;
    display:flex;
    justify-content:space-between;
    font-size:clamp(10px, 2vw, 14px);
    color:#cfd8dc;
    margin-top:10px;
    text-shadow:0 1px 1px rgba(0,0,0,.35);
  }

  .rating-panel{
    width:100%;
    max-width:100%;
    padding:15px 10px;
    background:linear-gradient(135deg,rgba(30,40,60,.9),rgba(20,30,45,.95));
    border-radius:16px;
    border:2px solid rgba(100,120,180,.3);
    box-sizing:border-box;
    margin:0;
  }
  .rating-title{
    font-size:clamp(18px, 3vw, 24px);
    color:#90caf9;
    text-align:center;
    margin-bottom:18px;
  }
  .question{
    margin:14px 0 8px;
    font-size:clamp(13px, 2.2vw, 16px);
    line-height:1.6;
    color:#e3f2fd;
    text-align:center;
  }
  .rating-scale{margin-bottom:16px}
  .scale-container{
    display:flex;
    align-items:center;
    gap:clamp(6px, 1.5vw, 10px);
    justify-content:center;
    flex-wrap:wrap;
  }
  .scale-end{
    font-size:clamp(10px, 2vw, 14px);
    color:#b0b0b0;
    min-width:clamp(60px, 15vw, 90px);
    text-align:center;
    flex-shrink:0;
  }
  .scale-buttons{
    display:flex;
    gap:clamp(4px, 1vw, 8px);
    justify-content:center;
    flex-wrap:wrap;
  }
  .scale-btn{
    width:clamp(32px, 5vw, 40px);
    height:clamp(32px, 5vw, 40px);
    border:2px solid rgba(100,120,180,.4);
    background:rgba(50,70,90,.6);
    border-radius:50%;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    color:#e0e0e0;
    font-size:clamp(10px, 2vw, 14px);
    font-weight:700;
    transition:all .15s;
    flex-shrink:0;
  }
  .scale-btn:hover{background:rgba(70,90,120,.85);border-color:rgba(120,140,200,.7);transform:translateY(-1px)}
  .scale-btn.selected{background:#42a5f5;border-color:#1976d2;color:#fff;box-shadow:0 4px 10px rgba(25,118,210,.35)}

  .btn{
    padding:clamp(10px, 2vw, 14px) clamp(20px, 4vw, 28px);
    font-size:clamp(14px, 2.5vw, 18px);
    font-weight:bold;
    border:none;
    border-radius:25px;
    cursor:pointer;
    transition:all .2s;
    text-transform:uppercase;
    letter-spacing:1px;
  }
  .btn-primary{
    background:linear-gradient(45deg,#42a5f5,#1976d2);
    color:#fff;
    box-shadow:0 4px 15px rgba(66,165,245,.3);
  }
  .btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(66,165,245,.45)}
  .btn-next{display:block;margin:20px auto 0}

  .progress-bar{position:fixed;top:0;left:0;height:4px;background:#42a5f5;transition:width .3s ease;z-index:1000;width:0%}

  .thank-page{
    text-align:center;
    max-width:100%;
    width:100%;
    box-sizing:border-box;
  }
  .thank-title{
    font-size:clamp(32px, 6vw, 48px);
    color:#64b5f6;
    margin-bottom:20px;
    text-shadow:0 0 30px rgba(66,165,245,.5);
  }
  .thank-message{
    font-size:clamp(14px, 2.8vw, 20px);
    color:#e0e0e0;
    line-height:1.6;
    text-align:left;
  }

  .grid-background{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    opacity:.05;
    background-image:
      linear-gradient(rgba(100,120,180,.3) 1px,transparent 1px),
      linear-gradient(90deg,rgba(100,120,180,.3) 1px,transparent 1px);
    background-size:50px 50px;
    pointer-events:none;
  }

  /* 針對極小螢幕的額外優化 */
  @media (max-width: 480px) {
    .page {
      padding: 10px 5px;
    }
    
    .checkbox-group {
      grid-template-columns: 1fr;
      gap: 12px;
    }
    
    .checkbox-item {
      padding: 12px 15px;
      font-size: 14px;
      min-height: 45px;
    }
    
    .light-page {
      gap: 15px;
      padding: 5px;
    }
    
    .scale-container {
      flex-direction: column;
      gap: 12px;
    }
    
    .scale-buttons {
      gap: 6px;
    }
    
    .rating-panel {
      padding: 15px 10px;
    }
    
    .light-canvas {
      width: 98%;
      height: 98vw;
      max-width: 380px;
      max-height: 380px;
    }
    
    .led-wrap {
      width: 98%;
      max-width: 380px;
    }
    
    .light-display {
      width: 100%;
    }
  }

  /* 針對超寬螢幕的限制 */
  @media (min-width: 1200px) {
    .page {
      max-width: 1200px;
      margin: 0 auto;
      left: 50%;
      transform: translateX(-50%);
    }
    
    .page.active {
      transform: translateX(-50%);
    }
    
    .page.prev {
      transform: translateX(calc(-50% - 100px));
    }
  }
</style>
</head>
<body>
  <div class="grid-background"></div>
  <div class="progress-bar" id="progressBar"></div>

  <!-- 研究說明 -->
  <div class="page active intro-page" id="page0">
    <h1 class="intro-title">光語言系統感知研究</h1>
    <div class="intro-content">
      <h3>研究目的</h3>
      <p>本研究旨在探討不同光互動模式對人類情緒與注意力狀態的影響。透過您的參與，我們希望了解光語言系統在人機互動設計中的應用潛力。</p>
      <h3>參與須知</h3>
      <p>• 本研究純屬學術研究用途，所有資料將以匿名方式處理<br>
         • 研究時間約需 10–15 分鐘<br>
         • 您將體驗 12 種不同的光互動效果<br>
         • 請根據您的直覺感受進行評分<br>
         • 您可隨時退出研究，不會有任何後果</p>
      <h3>隱私保護</h3>
      <p>您的個人資料與評分結果將嚴格保密，僅用於學術研究分析。研究結果將以統計數據呈現，不會揭露任何個人身份資訊。</p>
    </div>
    <button class="btn btn-primary" onclick="nextPage()">開始參與研究</button>
  </div>

  <!-- 基本資料 -->
  <div class="page profile-page" id="page1">
    <h2 class="intro-title" style="text-align:center;width:100%;">基本資料</h2>

    <div class="form-group">
      <div class="form-title">性別</div>
      <div class="checkbox-group" id="genderGroup">
        <div class="checkbox-item" data-value="male"><input type="checkbox"> <span>男性</span></div>
        <div class="checkbox-item" data-value="female"><input type="checkbox"> <span>女性</span></div>
        <div class="checkbox-item" data-value="Non-binary / gender diverse"><input type="checkbox"> <span>非二元性別</span></div>
        <div class="checkbox-item" data-value="Prefer not to say"><input type="checkbox"> <span>不願透露</span></div>
        <div class="checkbox-item" data-value="other-gender"><input type="checkbox"> <span>其他</span></div>
      </div>
      <input class="other-input" id="genderOther" placeholder="請輸入其他性別" style="display:none;">
    </div>

    <div class="form-group">
      <div class="form-title">年齡</div>
      <div class="checkbox-group" id="ageGroup">
        <div class="checkbox-item" data-value="18-"><input type="checkbox"> <span>18歲以下</span></div>
        <div class="checkbox-item" data-value="18-25"><input type="checkbox"> <span>18–25歲</span></div>
        <div class="checkbox-item" data-value="26-35"><input type="checkbox"> <span>26–35歲</span></div>
        <div class="checkbox-item" data-value="36-45"><input type="checkbox"> <span>36–45歲</span></div>
        <div class="checkbox-item" data-value="46-55"><input type="checkbox"> <span>46–55歲</span></div>
        <div class="checkbox-item" data-value="56+"><input type="checkbox"> <span>56歲以上</span></div>
        <div class="checkbox-item" data-value="other-age"><input type="checkbox"> <span>其他</span></div>
      </div>
      <input class="other-input" id="ageOther" placeholder="請輸入年齡" style="display:none;">
    </div>

    <div class="form-group">
      <div class="form-title">國家／地區</div>
      <div class="checkbox-group" id="nationalityGroup">
        <div class="checkbox-item" data-value="east-asia">
          <input type="checkbox"> <span>東亞</span>
        </div>
        <div class="checkbox-item" data-value="southeast-asia">
          <input type="checkbox"> <span>東南亞</span>
        </div>
        <div class="checkbox-item" data-value="south-asia">
          <input type="checkbox"> <span>南亞</span>
        </div>
        <div class="checkbox-item" data-value="europe">
          <input type="checkbox"> <span>歐洲</span>
        </div>
        <div class="checkbox-item" data-value="americas">
          <input type="checkbox"> <span>美洲</span>
        </div>
        <div class="checkbox-item" data-value="africa">
          <input type="checkbox"> <span>非洲</span>
        </div>
        <div class="checkbox-item" data-value="oceania">
          <input type="checkbox"> <span>大洋洲</span>
        </div>
        <div class="checkbox-item" data-value="prefer-not">
          <input type="checkbox"> <span>不願透露</span>
        </div>
        <div class="checkbox-item" data-value="other-nationality">
          <input type="checkbox"> <span>其他</span>
        </div>
      </div>
      <input class="other-input" id="nationalityOther"
             placeholder="請輸入國家／地區｜Please specify"
             style="display:none;">
    </div>

    <button class="btn btn-primary btn-next" onclick="nextPage()">NEXT</button>
  </div>

  <!-- 感謝頁 -->
  <div class="page thank-page" id="thankPage">
    <h1 class="thank-title">Thank You! ^^</h1>
    <div class="thank-message">
      <p>感謝您參與本次光語言系統感知研究！</p>
      <p>您的寶貴意見將有助於我們改善人機互動體驗。</p>
      <p>研究結果將用於學術發表，為未來的光互動設計提供重要參考。</p>
    </div>
  </div>

<script>
  /* ================= 可調參數 ================= */
  const SWEEP_DURATION_MS = 6400; // lightbar 從左→右一次所需時間（毫秒）

  /* ================= 全域狀態 ================= */
  let currentPage = 0;
  let totalPages  = 15;
  let selectedOptions = { gender:'', age:'', nationality:'' };
  let ratings = {};
  /* ================= 初始化 ================= */
  document.addEventListener('DOMContentLoaded',()=>{
    createLightPages();
    totalPages = 2 + lightTypes.length + 1;

    ['gender','age','nationality'].forEach(group=>{
      const el=document.getElementById(group+'Group');
      if(el){
        el.addEventListener('click',e=>{
          const item=e.target.closest('.checkbox-item');
          if(item) selectOption(group,item.dataset.value);
        });
      }
    });

    updateProgress();

    // 備援：點整塊也能選
    document.addEventListener('click',e=>{
      const item=e.target.closest('.checkbox-item'); if(!item) return;
      const groupEl=item.parentElement; if(!groupEl||!groupEl.id) return;
      const group=groupEl.id.replace('Group','');
      selectOption(group,item.dataset.value||'');
    },true);
    
    // 響應式視窗調整
    window.addEventListener('resize', () => {
      // 重新調整當前活動頁面的元素
      const activePage = document.querySelector('.page.active');
      if (activePage && activePage.querySelector('.light-canvas')) {
        const canvas = activePage.querySelector('.light-canvas');
        if (canvas) {
          const rect = canvas.getBoundingClientRect();
          canvas.width = rect.width;
          canvas.height = rect.height;
        }
      }
    });
  });
</script>
</body>
</html>
